'''
得到 测试集的经纬度进行评估
'''
import torch
import matplotlib.pyplot as plt
import numpy as np

width = 256
height = 256

max_lon_diff = 179.96099999999998
min_lon_diff = 100.0
max_lat_diff = 62.1
min_lat_diff = 0.6


# 密度图转经纬度
def graph_to_lon_lat(graphs):
    """
    标签图转经纬度
    :param graphs: shape n,width,height
    :return:
    """
    graphs = graphs.reshape((-1, 256, 256))
    result = []
    for g in graphs:
        x, y = find(g)
        lat = x * (max_lat_diff - min_lat_diff) / width + min_lat_diff
        lon = y * (max_lon_diff - min_lon_diff) / height + min_lon_diff
        result.append([lat, lon])
    return torch.tensor(result)


def find(g):
    for i in range(width):
        for j in range(height):
            if g[i][j] == 1.0:
                return i, j


# 画图loss曲线

def loss_show(train_loss, epoches):
    x_epoch = np.arange(1, epoches + 1)
    plt.figure()
    plt.plot(x_epoch, train_loss, label='train_loss')
    # plt.plot(x_epoch, test_loss, label='test_loss')
    plt.xlabel('Epoches')
    plt.ylabel('Loss')
    plt.legend()
    plt.show()


if __name__ == '__main__':
    train_loss = [1.186429774882842, 0.5543725194067372, 0.6299182590173216, 0.3456049783497441, 2.178115226632478, 0.3775045528095596, 0.2447358249705665, 0.186103738464263, 1.3886954728133825, 0.17646966410838827, 0.1269166451327655, 0.098505044698107, 0.08007112453330537, 1.5774849853953536, 0.8772972642767186, 0.5822623978768077, 0.43217608621534037, 0.34326877292929864, 0.28188676584740074, 0.23556756258619074, 0.199016377938037, 0.1699778975880876, 0.14615384048345137, 0.12608996467018613, 0.10877062346102023, 0.11476819901442041, 0.17420849496764795, 0.13010683822996763, 0.20152872302854546, 0.17742419434825377, 0.3052409230446329, 0.334824714087406, 0.38533320027042406, 0.3805975203915518, 0.4323152373449839, 0.41956542953088577, 0.4262174611949191, 0.4527232498500724, 0.389051984748518, 0.4105304210275716, 0.38055617096168654, 0.44916517679028367, 0.3423444412040467, 0.3904229329556835, 0.36855522151656295, 0.3389298241129335, 0.38246023092342885, 0.33925553160358446, 0.3386697027908296, 0.33544500126522414, 0.31509765480854074, 0.3404026148574693, 0.3110061375690358, 0.31536220253578257, 0.3088489097866173, 0.2902986084928318, 0.28630271687039305, 0.22081984976800728, 0.2604370962220187, 0.26413514704576563, 0.2570716161661002, 0.24961899574465898, 0.24644531720146842, 0.2369569168255037, 0.22621626019173738, 0.14337462738004267, 0.11104241503896761, 0.0902140494055894]

    loss_show(train_loss,68)